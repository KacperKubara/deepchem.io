<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Predicting Ki of Ligands to a Protein &mdash; deepchem 1.3.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.3.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="deepchem 1.3.1 documentation" href="../index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-inverse navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/logo.png"></span>
          deepchem</a>
        <span class="navbar-text navbar-version pull-left"><b>1.3</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="index.html">Notebooks</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../deepchem.html">deepchem package</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Predicting Ki of Ligands to a Protein</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="predicting-ki-of-ligands-to-a-protein">
<h1>Predicting Ki of Ligands to a Protein<a class="headerlink" href="#predicting-ki-of-ligands-to-a-protein" title="Permalink to this headline">¶</a></h1>
<p>In this notebook, we analyze the BACE enyzme and build machine learning
models for predicting the Ki of ligands to the protein. We will use the
<code class="docutils literal"><span class="pre">deepchem</span></code> library to load this data into memory, split into
train/test/validation folds, build and cross-validate models, and report
statistics.</p>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span>%load_ext autoreload
%autoreload 2
%pdb off
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>Automatic pdb calling has been turned OFF
</pre></div>
</div>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">deepchem</span> <span class="kn">as</span> <span class="nn">dc</span>
<span class="kn">from</span> <span class="nn">deepchem.utils.save</span> <span class="kn">import</span> <span class="n">load_from_disk</span>

<span class="n">current_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="s2">&quot;__file__&quot;</span><span class="p">))</span>
<span class="n">dc</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">download_url</span><span class="p">(</span><span class="s2">&quot;https://s3-us-west-1.amazonaws.com/deepchem.io/datasets/desc_canvas_aug30.csv&quot;</span><span class="p">,</span>
                      <span class="n">current_dir</span><span class="p">)</span>
<span class="n">dataset_file</span> <span class="o">=</span> <span class="s2">&quot;desc_canvas_aug30.csv&quot;</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_from_disk</span><span class="p">(</span><span class="n">dataset_file</span><span class="p">)</span>
<span class="n">num_display</span><span class="o">=</span><span class="mi">10</span>
<span class="n">pretty_columns</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">column</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="n">num_display</span><span class="p">]])</span>
    <span class="o">+</span> <span class="s2">&quot;,...]&quot;</span><span class="p">)</span>

<span class="n">dc</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">download_url</span><span class="p">(</span><span class="s2">&quot;https://s3-us-west-1.amazonaws.com/deepchem.io/datasets/crystal_desc_canvas_aug30.csv&quot;</span><span class="p">,</span>
                      <span class="n">current_dir</span><span class="p">)</span>
<span class="n">crystal_dataset_file</span> <span class="o">=</span> <span class="s2">&quot;crystal_desc_canvas_aug30.csv&quot;</span>
<span class="n">crystal_dataset</span> <span class="o">=</span> <span class="n">load_from_disk</span><span class="p">(</span><span class="n">crystal_dataset_file</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Columns of dataset: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pretty_columns</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Number of examples in dataset: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Number of examples in crystal dataset: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">crystal_dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>Columns of dataset: [&#39;mol&#39;,&#39;CID&#39;,&#39;Class&#39;,&#39;Model&#39;,&#39;pIC50&#39;,&#39;MW&#39;,&#39;AlogP&#39;,&#39;HBA&#39;,&#39;HBD&#39;,&#39;RB&#39;,...]
Number of examples in dataset: 1522
Number of examples in crystal dataset: 25
</pre></div>
</div>
<p>To gain a visual understanding of compounds in our dataset, let’s draw
them using rdkit. We define a couple of helper functions to get started.</p>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">Draw</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">islice</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>

<span class="k">def</span> <span class="nf">display_images</span><span class="p">(</span><span class="n">filenames</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Helper to pretty-print images.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
        <span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">mols_to_pngs</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Helper to write RDKit mols to png files.&quot;&quot;&quot;</span>
    <span class="n">filenames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mol</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mols</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;BACE_</span><span class="si">%s%d</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">basename</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">Draw</span><span class="o">.</span><span class="n">MolToFile</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">filenames</span>
</pre></div>
</div>
<p>Now, we display a compound from the dataset. Note the complex ring
structures and polar structures.</p>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="n">num_to_display</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">molecules</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">islice</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">iterrows</span><span class="p">(),</span> <span class="n">num_to_display</span><span class="p">):</span>
    <span class="n">molecules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;mol&quot;</span><span class="p">]))</span>
<span class="n">display_images</span><span class="p">(</span><span class="n">mols_to_pngs</span><span class="p">(</span><span class="n">molecules</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="s2">&quot;dataset&quot;</span><span class="p">))</span>
</pre></div>
</div>
<img alt="../_images/BACE_6_0.png" src="../_images/BACE_6_0.png" />
<img alt="../_images/BACE_6_1.png" src="../_images/BACE_6_1.png" />
<img alt="../_images/BACE_6_2.png" src="../_images/BACE_6_2.png" />
<img alt="../_images/BACE_6_3.png" src="../_images/BACE_6_3.png" />
<img alt="../_images/BACE_6_4.png" src="../_images/BACE_6_4.png" />
<img alt="../_images/BACE_6_5.png" src="../_images/BACE_6_5.png" />
<img alt="../_images/BACE_6_6.png" src="../_images/BACE_6_6.png" />
<img alt="../_images/BACE_6_7.png" src="../_images/BACE_6_7.png" />
<img alt="../_images/BACE_6_8.png" src="../_images/BACE_6_8.png" />
<img alt="../_images/BACE_6_9.png" src="../_images/BACE_6_9.png" />
<img alt="../_images/BACE_6_10.png" src="../_images/BACE_6_10.png" />
<img alt="../_images/BACE_6_11.png" src="../_images/BACE_6_11.png" />
<p>Now let’s picture the compounds in the crystal structure collection</p>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="n">num_to_display</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">molecules</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">islice</span><span class="p">(</span><span class="n">crystal_dataset</span><span class="o">.</span><span class="n">iterrows</span><span class="p">(),</span> <span class="n">num_to_display</span><span class="p">):</span>
    <span class="n">molecules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;mol&quot;</span><span class="p">]))</span>
<span class="n">display_images</span><span class="p">(</span><span class="n">mols_to_pngs</span><span class="p">(</span><span class="n">molecules</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="s2">&quot;crystal_dataset&quot;</span><span class="p">))</span>
</pre></div>
</div>
<img alt="../_images/BACE_8_0.png" src="../_images/BACE_8_0.png" />
<img alt="../_images/BACE_8_1.png" src="../_images/BACE_8_1.png" />
<img alt="../_images/BACE_8_2.png" src="../_images/BACE_8_2.png" />
<img alt="../_images/BACE_8_3.png" src="../_images/BACE_8_3.png" />
<img alt="../_images/BACE_8_4.png" src="../_images/BACE_8_4.png" />
<img alt="../_images/BACE_8_5.png" src="../_images/BACE_8_5.png" />
<img alt="../_images/BACE_8_6.png" src="../_images/BACE_8_6.png" />
<img alt="../_images/BACE_8_7.png" src="../_images/BACE_8_7.png" />
<img alt="../_images/BACE_8_8.png" src="../_images/BACE_8_8.png" />
<img alt="../_images/BACE_8_9.png" src="../_images/BACE_8_9.png" />
<img alt="../_images/BACE_8_10.png" src="../_images/BACE_8_10.png" />
<img alt="../_images/BACE_8_11.png" src="../_images/BACE_8_11.png" />
<p>Analyzing the distribution of pIC50 values in the dataset gives us a
nice spread.</p>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span>%matplotlib inline
import matplotlib
import numpy as np
import matplotlib.pyplot as plt

pIC50s = np.array(dataset[&quot;pIC50&quot;])
# Remove some dirty data from the dataset
pIC50s = [pIC50 for pIC50 in pIC50s if pIC50 != &#39;&#39;]
n, bins, patches = plt.hist(pIC50s, 50, facecolor=&#39;green&#39;, alpha=0.75)
plt.xlabel(&#39;Measured pIC50&#39;)
plt.ylabel(&#39;Number of compounds&#39;)
plt.title(r&#39;Histogram of pIC50 Values&#39;)
plt.grid(True)
plt.show()
</pre></div>
</div>
<img alt="../_images/BACE_10_0.png" src="../_images/BACE_10_0.png" />
<p>We now featurize the data using the Canvas samples. To do so, we must
specify the columns in the data input that correspond to the features.
(Note that CanvasUID is excluded!)</p>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="n">user_specified_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MW&#39;</span><span class="p">,</span><span class="s1">&#39;AlogP&#39;</span><span class="p">,</span><span class="s1">&#39;HBA&#39;</span><span class="p">,</span><span class="s1">&#39;HBD&#39;</span><span class="p">,</span><span class="s1">&#39;RB&#39;</span><span class="p">,</span><span class="s1">&#39;HeavyAtomCount&#39;</span><span class="p">,</span><span class="s1">&#39;ChiralCenterCount&#39;</span><span class="p">,</span><span class="s1">&#39;ChiralCenterCountAllPossible&#39;</span><span class="p">,</span><span class="s1">&#39;RingCount&#39;</span><span class="p">,</span><span class="s1">&#39;PSA&#39;</span><span class="p">,</span><span class="s1">&#39;Estate&#39;</span><span class="p">,</span><span class="s1">&#39;MR&#39;</span><span class="p">,</span><span class="s1">&#39;Polar&#39;</span><span class="p">,</span><span class="s1">&#39;sLi_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssBe_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssssBem_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sBH2_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssBH_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sssB_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssssBm_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sCH3_Key&#39;</span><span class="p">,</span><span class="s1">&#39;dCH2_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssCH2_Key&#39;</span><span class="p">,</span><span class="s1">&#39;tCH_Key&#39;</span><span class="p">,</span><span class="s1">&#39;dsCH_Key&#39;</span><span class="p">,</span><span class="s1">&#39;aaCH_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sssCH_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ddC_Key&#39;</span><span class="p">,</span><span class="s1">&#39;tsC_Key&#39;</span><span class="p">,</span><span class="s1">&#39;dssC_Key&#39;</span><span class="p">,</span><span class="s1">&#39;aasC_Key&#39;</span><span class="p">,</span><span class="s1">&#39;aaaC_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssssC_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sNH3_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sNH2_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssNH2_Key&#39;</span><span class="p">,</span><span class="s1">&#39;dNH_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssNH_Key&#39;</span><span class="p">,</span><span class="s1">&#39;aaNH_Key&#39;</span><span class="p">,</span><span class="s1">&#39;tN_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sssNH_Key&#39;</span><span class="p">,</span><span class="s1">&#39;dsN_Key&#39;</span><span class="p">,</span><span class="s1">&#39;aaN_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sssN_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ddsN_Key&#39;</span><span class="p">,</span><span class="s1">&#39;aasN_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssssN_Key&#39;</span><span class="p">,</span><span class="s1">&#39;daaN_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sOH_Key&#39;</span><span class="p">,</span><span class="s1">&#39;dO_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssO_Key&#39;</span><span class="p">,</span><span class="s1">&#39;aaO_Key&#39;</span><span class="p">,</span><span class="s1">&#39;aOm_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sOm_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sF_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sSiH3_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssSiH2_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sssSiH_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssssSi_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sPH2_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssPH_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sssP_Key&#39;</span><span class="p">,</span><span class="s1">&#39;dsssP_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ddsP_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sssssP_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sSH_Key&#39;</span><span class="p">,</span><span class="s1">&#39;dS_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssS_Key&#39;</span><span class="p">,</span><span class="s1">&#39;aaS_Key&#39;</span><span class="p">,</span><span class="s1">&#39;dssS_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ddssS_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssssssS_Key&#39;</span><span class="p">,</span><span class="s1">&#39;Sm_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sCl_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sGeH3_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssGeH2_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sssGeH_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssssGe_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sAsH2_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssAsH_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sssAs_Key&#39;</span><span class="p">,</span><span class="s1">&#39;dsssAs_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ddsAs_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sssssAs_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sSeH_Key&#39;</span><span class="p">,</span><span class="s1">&#39;dSe_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssSe_Key&#39;</span><span class="p">,</span><span class="s1">&#39;aaSe_Key&#39;</span><span class="p">,</span><span class="s1">&#39;dssSe_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssssssSe_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ddssSe_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sBr_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sSnH3_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssSnH2_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sssSnH_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssssSn_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sI_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sPbH3_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssPbH2_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sssPbH_Key&#39;</span><span class="p">,</span><span class="s1">&#39;ssssPb_Key&#39;</span><span class="p">,</span><span class="s1">&#39;sLi_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssBe_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssssBem_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sBH2_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssBH_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sssB_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssssBm_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sCH3_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;dCH2_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssCH2_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;tCH_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;dsCH_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;aaCH_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sssCH_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ddC_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;tsC_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;dssC_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;aasC_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;aaaC_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssssC_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sNH3_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sNH2_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssNH2_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;dNH_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssNH_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;aaNH_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;tN_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sssNH_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;dsN_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;aaN_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sssN_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ddsN_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;aasN_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssssN_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;daaN_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sOH_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;dO_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssO_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;aaO_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;aOm_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sOm_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sF_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sSiH3_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssSiH2_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sssSiH_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssssSi_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sPH2_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssPH_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sssP_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;dsssP_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ddsP_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sssssP_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sSH_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;dS_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssS_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;aaS_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;dssS_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ddssS_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssssssS_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;Sm_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sCl_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sGeH3_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssGeH2_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sssGeH_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssssGe_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sAsH2_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssAsH_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sssAs_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;dsssAs_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ddsAs_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sssssAs_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sSeH_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;dSe_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssSe_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;aaSe_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;dssSe_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssssssSe_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ddssSe_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sBr_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sSnH3_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssSnH2_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sssSnH_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssssSn_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sI_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sPbH3_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssPbH2_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sssPbH_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;ssssPb_Cnt&#39;</span><span class="p">,</span><span class="s1">&#39;sLi_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssBe_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssssBem_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sBH2_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssBH_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sssB_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssssBm_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sCH3_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;dCH2_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssCH2_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;tCH_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;dsCH_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;aaCH_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sssCH_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ddC_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;tsC_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;dssC_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;aasC_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;aaaC_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssssC_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sNH3_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sNH2_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssNH2_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;dNH_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssNH_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;aaNH_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;tN_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sssNH_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;dsN_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;aaN_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sssN_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ddsN_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;aasN_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssssN_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;daaN_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sOH_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;dO_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssO_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;aaO_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;aOm_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sOm_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sF_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sSiH3_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssSiH2_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sssSiH_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssssSi_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sPH2_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssPH_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sssP_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;dsssP_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ddsP_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sssssP_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sSH_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;dS_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssS_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;aaS_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;dssS_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ddssS_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssssssS_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;Sm_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sCl_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sGeH3_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssGeH2_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sssGeH_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssssGe_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sAsH2_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssAsH_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sssAs_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;dsssAs_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ddsAs_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sssssAs_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sSeH_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;dSe_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssSe_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;aaSe_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;dssSe_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssssssSe_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ddssSe_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sBr_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sSnH3_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssSnH2_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sssSnH_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssssSn_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sI_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sPbH3_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssPbH2_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sssPbH_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ssssPb_Sum&#39;</span><span class="p">,</span><span class="s1">&#39;sLi_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssBe_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssssBem_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sBH2_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssBH_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sssB_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssssBm_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sCH3_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;dCH2_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssCH2_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;tCH_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;dsCH_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;aaCH_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sssCH_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ddC_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;tsC_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;dssC_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;aasC_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;aaaC_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssssC_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sNH3_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sNH2_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssNH2_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;dNH_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssNH_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;aaNH_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;tN_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sssNH_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;dsN_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;aaN_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sssN_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ddsN_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;aasN_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssssN_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;daaN_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sOH_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;dO_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssO_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;aaO_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;aOm_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sOm_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sF_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sSiH3_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssSiH2_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sssSiH_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssssSi_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sPH2_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssPH_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sssP_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;dsssP_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ddsP_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sssssP_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sSH_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;dS_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssS_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;aaS_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;dssS_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ddssS_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssssssS_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;Sm_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sCl_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sGeH3_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssGeH2_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sssGeH_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssssGe_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sAsH2_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssAsH_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sssAs_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;dsssAs_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ddsAs_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sssssAs_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sSeH_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;dSe_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssSe_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;aaSe_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;dssSe_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssssssSe_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ddssSe_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sBr_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sSnH3_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssSnH2_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sssSnH_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssssSn_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sI_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sPbH3_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssPbH2_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;sssPbH_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;ssssPb_Avg&#39;</span><span class="p">,</span><span class="s1">&#39;First Zagreb (ZM1)&#39;</span><span class="p">,</span><span class="s1">&#39;First Zagreb index by valence vertex degrees (ZM1V)&#39;</span><span class="p">,</span><span class="s1">&#39;Second Zagreb (ZM2)&#39;</span><span class="p">,</span><span class="s1">&#39;Second Zagreb index by valence vertex degrees (ZM2V)&#39;</span><span class="p">,</span><span class="s1">&#39;Polarity (Pol)&#39;</span><span class="p">,</span><span class="s1">&#39;Narumi Simple Topological (NST)&#39;</span><span class="p">,</span><span class="s1">&#39;Narumi Harmonic Topological (NHT)&#39;</span><span class="p">,</span><span class="s1">&#39;Narumi Geometric Topological (NGT)&#39;</span><span class="p">,</span><span class="s1">&#39;Total structure connectivity (TSC)&#39;</span><span class="p">,</span><span class="s1">&#39;Wiener (W)&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Wiener (MW)&#39;</span><span class="p">,</span><span class="s1">&#39;Xu (Xu)&#39;</span><span class="p">,</span><span class="s1">&#39;Quadratic (QIndex)&#39;</span><span class="p">,</span><span class="s1">&#39;Radial centric (RC)&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Square Distance Balaban (MSDB)&#39;</span><span class="p">,</span><span class="s1">&#39;Superpendentic (SP)&#39;</span><span class="p">,</span><span class="s1">&#39;Harary (Har)&#39;</span><span class="p">,</span><span class="s1">&#39;Log of product of row sums (LPRS)&#39;</span><span class="p">,</span><span class="s1">&#39;Pogliani (Pog)&#39;</span><span class="p">,</span><span class="s1">&#39;Schultz Molecular Topological (SMT)&#39;</span><span class="p">,</span><span class="s1">&#39;Schultz Molecular Topological by valence vertex degrees (SMTV)&#39;</span><span class="p">,</span><span class="s1">&#39;Mean Distance Degree Deviation (MDDD)&#39;</span><span class="p">,</span><span class="s1">&#39;Ramification (Ram)&#39;</span><span class="p">,</span><span class="s1">&#39;Gutman Molecular Topological (GMT)&#39;</span><span class="p">,</span><span class="s1">&#39;Gutman MTI by valence vertex degrees (GMTV)&#39;</span><span class="p">,</span><span class="s1">&#39;Average vertex distance degree (AVDD)&#39;</span><span class="p">,</span><span class="s1">&#39;Unipolarity (UP)&#39;</span><span class="p">,</span><span class="s1">&#39;Centralization (CENT)&#39;</span><span class="p">,</span><span class="s1">&#39;Variation (VAR)&#39;</span><span class="p">,</span><span class="s1">&#39;Molecular electrotopological variation (MEV)&#39;</span><span class="p">,</span><span class="s1">&#39;Maximal electrotopological positive variation (MEPV)&#39;</span><span class="p">,</span><span class="s1">&#39;Maximal electrotopological negative variation (MENV)&#39;</span><span class="p">,</span><span class="s1">&#39;Eccentric connectivity (ECCc)&#39;</span><span class="p">,</span><span class="s1">&#39;Eccentricity (ECC)&#39;</span><span class="p">,</span><span class="s1">&#39;Average eccentricity (AECC)&#39;</span><span class="p">,</span><span class="s1">&#39;Eccentric (DECC)&#39;</span><span class="p">,</span><span class="s1">&#39;Valence connectivity index chi-0 (vX0)&#39;</span><span class="p">,</span><span class="s1">&#39;Valence connectivity index chi-1 (vX1)&#39;</span><span class="p">,</span><span class="s1">&#39;Valence connectivity index chi-2 (vX2)&#39;</span><span class="p">,</span><span class="s1">&#39;Valence connectivity index chi-3 (vX3)&#39;</span><span class="p">,</span><span class="s1">&#39;Valence connectivity index chi-4 (vX4)&#39;</span><span class="p">,</span><span class="s1">&#39;Valence connectivity index chi-5 (vX5)&#39;</span><span class="p">,</span><span class="s1">&#39;Average valence connectivity index chi-0 (AvX0)&#39;</span><span class="p">,</span><span class="s1">&#39;Average valence connectivity index chi-1 (AvX1)&#39;</span><span class="p">,</span><span class="s1">&#39;Average valence connectivity index chi-2 (AvX2)&#39;</span><span class="p">,</span><span class="s1">&#39;Average valence connectivity index chi-3 (AvX3)&#39;</span><span class="p">,</span><span class="s1">&#39;Average valence connectivity index chi-4 (AvX4)&#39;</span><span class="p">,</span><span class="s1">&#39;Average valence connectivity index chi-5 (AvX5)&#39;</span><span class="p">,</span><span class="s1">&#39;Quasi Wiener (QW)&#39;</span><span class="p">,</span><span class="s1">&#39;First Mohar (FM)&#39;</span><span class="p">,</span><span class="s1">&#39;Second Mohar (SM)&#39;</span><span class="p">,</span><span class="s1">&#39;Spanning tree number (STN)&#39;</span><span class="p">,</span><span class="s1">&#39;Kier benzene-likeliness index (KBLI)&#39;</span><span class="p">,</span><span class="s1">&#39;Topological charge index of order 1 (TCI1)&#39;</span><span class="p">,</span><span class="s1">&#39;Topological charge index of order 2 (TCI2)&#39;</span><span class="p">,</span><span class="s1">&#39;Topological charge index of order 3 (TCI3)&#39;</span><span class="p">,</span><span class="s1">&#39;Topological charge index of order 4 (TCI4)&#39;</span><span class="p">,</span><span class="s1">&#39;Topological charge index of order 5 (TCI5)&#39;</span><span class="p">,</span><span class="s1">&#39;Topological charge index of order 6 (TCI6)&#39;</span><span class="p">,</span><span class="s1">&#39;Topological charge index of order 7 (TCI7)&#39;</span><span class="p">,</span><span class="s1">&#39;Topological charge index of order 8 (TCI8)&#39;</span><span class="p">,</span><span class="s1">&#39;Topological charge index of order 9 (TCI9)&#39;</span><span class="p">,</span><span class="s1">&#39;Topological charge index of order 10 (TCI10)&#39;</span><span class="p">,</span><span class="s1">&#39;Mean topological charge index of order 1 (MTCI1)&#39;</span><span class="p">,</span><span class="s1">&#39;Mean topological charge index of order 2 (MTCI2)&#39;</span><span class="p">,</span><span class="s1">&#39;Mean topological charge index of order 3 (MTCI3)&#39;</span><span class="p">,</span><span class="s1">&#39;Mean topological charge index of order 4 (MTCI4)&#39;</span><span class="p">,</span><span class="s1">&#39;Mean topological charge index of order 5 (MTCI5)&#39;</span><span class="p">,</span><span class="s1">&#39;Mean topological charge index of order 6 (MTCI6)&#39;</span><span class="p">,</span><span class="s1">&#39;Mean topological charge index of order 7 (MTCI7)&#39;</span><span class="p">,</span><span class="s1">&#39;Mean topological charge index of order 8 (MTCI8)&#39;</span><span class="p">,</span><span class="s1">&#39;Mean topological charge index of order 9 (MTCI9)&#39;</span><span class="p">,</span><span class="s1">&#39;Mean topological charge index of order 10 (MTCI10)&#39;</span><span class="p">,</span><span class="s1">&#39;Global topological charge (GTC)&#39;</span><span class="p">,</span><span class="s1">&#39;Hyper-distance-path index (HDPI)&#39;</span><span class="p">,</span><span class="s1">&#39;Reciprocal hyper-distance-path index (RHDPI)&#39;</span><span class="p">,</span><span class="s1">&#39;Square reciprocal distance sum (SRDS)&#39;</span><span class="p">,</span><span class="s1">&#39;Modified Randic connectivity (MRC)&#39;</span><span class="p">,</span><span class="s1">&#39;Balaban centric (BC)&#39;</span><span class="p">,</span><span class="s1">&#39;Lopping centric (LC)&#39;</span><span class="p">,</span><span class="s1">&#39;Kier Hall electronegativity (KHE)&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between N..N (STD(N N))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between N..O (STD(N O))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between N..S (STD(N S))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between N..P (STD(N P))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between N..F (STD(N F))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between N..Cl (STD(N Cl))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between N..Br (STD(N Br))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between N..I (STD(N I))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between O..O (STD(O O))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between O..S (STD(O S))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between O..P (STD(O P))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between O..F (STD(O F))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between O..Cl (STD(O Cl))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between O..Br (STD(O Br))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between O..I (STD(O I))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between S..S (STD(S S))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between S..P (STD(S P))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between S..F (STD(S F))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between S..Cl (STD(S Cl))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between S..Br (STD(S Br))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between S..I (STD(S I))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between P..P (STD(P P))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between P..F (STD(P F))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between P..Cl (STD(P Cl))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between P..Br (STD(P Br))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between P..I (STD(P I))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between F..F (STD(F F))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between F..Cl (STD(F Cl))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between F..Br (STD(F Br))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between F..I (STD(F I))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between Cl..Cl (STD(Cl Cl))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between Cl..Br (STD(Cl Br))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between Cl..I (STD(Cl I))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between Br..Br (STD(Br Br))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between Br..I (STD(Br I))&#39;</span><span class="p">,</span><span class="s1">&#39;Sum of topological distances between I..I (STD(I I))&#39;</span><span class="p">,</span><span class="s1">&#39;Wiener-type index from Z weighted distance matrix - Barysz matrix (WhetZ)&#39;</span><span class="p">,</span><span class="s1">&#39;Wiener-type index from electronegativity weighted distance matrix (Whete)&#39;</span><span class="p">,</span><span class="s1">&#39;Wiener-type index from mass weighted distance matrix (Whetm)&#39;</span><span class="p">,</span><span class="s1">&#39;Wiener-type index from van der waals weighted distance matrix (Whetv)&#39;</span><span class="p">,</span><span class="s1">&#39;Wiener-type index from polarizability weighted distance matrix (Whetp)&#39;</span><span class="p">,</span><span class="s1">&#39;Balaban-type index from Z weighted distance matrix - Barysz matrix (JhetZ)&#39;</span><span class="p">,</span><span class="s1">&#39;Balaban-type index from electronegativity weighted distance matrix (Jhete)&#39;</span><span class="p">,</span><span class="s1">&#39;Balaban-type index from mass weighted distance matrix (Jhetm)&#39;</span><span class="p">,</span><span class="s1">&#39;Balaban-type index from van der waals weighted distance matrix (Jhetv)&#39;</span><span class="p">,</span><span class="s1">&#39;Balaban-type index from polarizability weighted distance matrix (Jhetp)&#39;</span><span class="p">,</span><span class="s1">&#39;Topological diameter (TD)&#39;</span><span class="p">,</span><span class="s1">&#39;Topological radius (TR)&#39;</span><span class="p">,</span><span class="s1">&#39;Petitjean 2D shape (PJ2DS)&#39;</span><span class="p">,</span><span class="s1">&#39;Balaban distance connectivity index (J)&#39;</span><span class="p">,</span><span class="s1">&#39;Solvation connectivity index chi-0 (SCIX0)&#39;</span><span class="p">,</span><span class="s1">&#39;Solvation connectivity index chi-1 (SCIX1)&#39;</span><span class="p">,</span><span class="s1">&#39;Solvation connectivity index chi-2 (SCIX2)&#39;</span><span class="p">,</span><span class="s1">&#39;Solvation connectivity index chi-3 (SCIX3)&#39;</span><span class="p">,</span><span class="s1">&#39;Solvation connectivity index chi-4 (SCIX4)&#39;</span><span class="p">,</span><span class="s1">&#39;Solvation connectivity index chi-5 (SCIX5)&#39;</span><span class="p">,</span><span class="s1">&#39;Connectivity index chi-0 (CIX0)&#39;</span><span class="p">,</span><span class="s1">&#39;Connectivity chi-1 [Randic connectivity] (CIX1)&#39;</span><span class="p">,</span><span class="s1">&#39;Connectivity index chi-2 (CIX2)&#39;</span><span class="p">,</span><span class="s1">&#39;Connectivity index chi-3 (CIX3)&#39;</span><span class="p">,</span><span class="s1">&#39;Connectivity index chi-4 (CIX4)&#39;</span><span class="p">,</span><span class="s1">&#39;Connectivity index chi-5 (CIX5)&#39;</span><span class="p">,</span><span class="s1">&#39;Average connectivity index chi-0 (ACIX0)&#39;</span><span class="p">,</span><span class="s1">&#39;Average connectivity index chi-1 (ACIX1)&#39;</span><span class="p">,</span><span class="s1">&#39;Average connectivity index chi-2 (ACIX2)&#39;</span><span class="p">,</span><span class="s1">&#39;Average connectivity index chi-3 (ACIX3)&#39;</span><span class="p">,</span><span class="s1">&#39;Average connectivity index chi-4 (ACIX4)&#39;</span><span class="p">,</span><span class="s1">&#39;Average connectivity index chi-5 (ACIX5)&#39;</span><span class="p">,</span><span class="s1">&#39;reciprocal distance Randic-type index (RDR)&#39;</span><span class="p">,</span><span class="s1">&#39;reciprocal distance square Randic-type index (RDSR)&#39;</span><span class="p">,</span><span class="s1">&#39;1-path Kier alpha-modified shape index (KAMS1)&#39;</span><span class="p">,</span><span class="s1">&#39;2-path Kier alpha-modified shape index (KAMS2)&#39;</span><span class="p">,</span><span class="s1">&#39;3-path Kier alpha-modified shape index (KAMS3)&#39;</span><span class="p">,</span><span class="s1">&#39;Kier flexibility (KF)&#39;</span><span class="p">,</span><span class="s1">&#39;path/walk 2 - Randic shape index (RSIpw2)&#39;</span><span class="p">,</span><span class="s1">&#39;path/walk 3 - Randic shape index (RSIpw3)&#39;</span><span class="p">,</span><span class="s1">&#39;path/walk 4 - Randic shape index (RSIpw4)&#39;</span><span class="p">,</span><span class="s1">&#39;path/walk 5 - Randic shape index (RSIpw5)&#39;</span><span class="p">,</span><span class="s1">&#39;E-state topological parameter (ETP)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring Count 3 (RNGCNT3)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring Count 4 (RNGCNT4)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring Count 5 (RNGCNT5)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring Count 6 (RNGCNT6)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring Count 7 (RNGCNT7)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring Count 8 (RNGCNT8)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring Count 9 (RNGCNT9)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring Count 10 (RNGCNT10)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring Count 11 (RNGCNT11)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring Count 12 (RNGCNT12)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring Count 13 (RNGCNT13)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring Count 14 (RNGCNT14)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring Count 15 (RNGCNT15)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring Count 16 (RNGCNT16)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring Count 17 (RNGCNT17)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring Count 18 (RNGCNT18)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring Count 19 (RNGCNT19)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring Count 20 (RNGCNT20)&#39;</span><span class="p">,</span><span class="s1">&#39;Atom Count (ATMCNT)&#39;</span><span class="p">,</span><span class="s1">&#39;Bond Count (BNDCNT)&#39;</span><span class="p">,</span><span class="s1">&#39;Atoms in Ring System (ATMRNGCNT)&#39;</span><span class="p">,</span><span class="s1">&#39;Bonds in Ring System (BNDRNGCNT)&#39;</span><span class="p">,</span><span class="s1">&#39;Cyclomatic number (CYCLONUM)&#39;</span><span class="p">,</span><span class="s1">&#39;Number of ring systems (NRS)&#39;</span><span class="p">,</span><span class="s1">&#39;Normalized number of ring systems (NNRS)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring Fusion degree (RFD)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring perimeter (RNGPERM)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring bridge count (RNGBDGE)&#39;</span><span class="p">,</span><span class="s1">&#39;Molecule cyclized degree (MCD)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring Fusion density (RFDELTA)&#39;</span><span class="p">,</span><span class="s1">&#39;Ring complexity index (RCI)&#39;</span><span class="p">,</span><span class="s1">&#39;Van der Waals surface area (VSA)&#39;</span><span class="p">,</span><span class="s1">&#39;MR1 (MR1)&#39;</span><span class="p">,</span><span class="s1">&#39;MR2 (MR2)&#39;</span><span class="p">,</span><span class="s1">&#39;MR3 (MR3)&#39;</span><span class="p">,</span><span class="s1">&#39;MR4 (MR4)&#39;</span><span class="p">,</span><span class="s1">&#39;MR5 (MR5)&#39;</span><span class="p">,</span><span class="s1">&#39;MR6 (MR6)&#39;</span><span class="p">,</span><span class="s1">&#39;MR7 (MR7)&#39;</span><span class="p">,</span><span class="s1">&#39;MR8 (MR8)&#39;</span><span class="p">,</span><span class="s1">&#39;ALOGP1 (ALOGP1)&#39;</span><span class="p">,</span><span class="s1">&#39;ALOGP2 (ALOGP2)&#39;</span><span class="p">,</span><span class="s1">&#39;ALOGP3 (ALOGP3)&#39;</span><span class="p">,</span><span class="s1">&#39;ALOGP4 (ALOGP4)&#39;</span><span class="p">,</span><span class="s1">&#39;ALOGP5 (ALOGP5)&#39;</span><span class="p">,</span><span class="s1">&#39;ALOGP6 (ALOGP6)&#39;</span><span class="p">,</span><span class="s1">&#39;ALOGP7 (ALOGP7)&#39;</span><span class="p">,</span><span class="s1">&#39;ALOGP8 (ALOGP8)&#39;</span><span class="p">,</span><span class="s1">&#39;ALOGP9 (ALOGP9)&#39;</span><span class="p">,</span><span class="s1">&#39;ALOGP10 (ALOGP10)&#39;</span><span class="p">,</span><span class="s1">&#39;PEOE1 (PEOE1)&#39;</span><span class="p">,</span><span class="s1">&#39;PEOE2 (PEOE2)&#39;</span><span class="p">,</span><span class="s1">&#39;PEOE3 (PEOE3)&#39;</span><span class="p">,</span><span class="s1">&#39;PEOE4 (PEOE4)&#39;</span><span class="p">,</span><span class="s1">&#39;PEOE5 (PEOE5)&#39;</span><span class="p">,</span><span class="s1">&#39;PEOE6 (PEOE6)&#39;</span><span class="p">,</span><span class="s1">&#39;PEOE7 (PEOE7)&#39;</span><span class="p">,</span><span class="s1">&#39;PEOE8 (PEOE8)&#39;</span><span class="p">,</span><span class="s1">&#39;PEOE9 (PEOE9)&#39;</span><span class="p">,</span><span class="s1">&#39;PEOE10 (PEOE10)&#39;</span><span class="p">,</span><span class="s1">&#39;PEOE11 (PEOE11)&#39;</span><span class="p">,</span><span class="s1">&#39;PEOE12 (PEOE12)&#39;</span><span class="p">,</span><span class="s1">&#39;PEOE13 (PEOE13)&#39;</span><span class="p">,</span><span class="s1">&#39;PEOE14 (PEOE14)&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">deepchem</span> <span class="kn">as</span> <span class="nn">dc</span>
<span class="kn">import</span> <span class="nn">tempfile</span><span class="o">,</span> <span class="nn">shutil</span>

<span class="n">featurizer</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">feat</span><span class="o">.</span><span class="n">UserDefinedFeaturizer</span><span class="p">(</span><span class="n">user_specified_features</span><span class="p">)</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">UserCSVLoader</span><span class="p">(</span>
      <span class="n">tasks</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Class&quot;</span><span class="p">],</span> <span class="n">smiles_field</span><span class="o">=</span><span class="s2">&quot;mol&quot;</span><span class="p">,</span> <span class="n">id_field</span><span class="o">=</span><span class="s2">&quot;mol&quot;</span><span class="p">,</span>
      <span class="n">featurizer</span><span class="o">=</span><span class="n">featurizer</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">featurize</span><span class="p">(</span><span class="n">dataset_file</span><span class="p">)</span>
<span class="n">crystal_dataset</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">featurize</span><span class="p">(</span><span class="n">crystal_dataset_file</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>Loading raw samples now.
shard_size: 8192
About to start loading CSV from desc_canvas_aug30.csv
Loading shard 1 of size 8192.
TIMING: user specified processing took 0.100 s
TIMING: featurizing shard 0 took 0.104 s
TIMING: dataset construction took 0.363 s
Loading dataset from disk.
Loading raw samples now.
shard_size: 8192
About to start loading CSV from crystal_desc_canvas_aug30.csv
Loading shard 1 of size 8192.
TIMING: user specified processing took 0.143 s
TIMING: featurizing shard 0 took 0.143 s
TIMING: dataset construction took 0.171 s
Loading dataset from disk.
</pre></div>
</div>
<p>This data is already split into three subsets “Train” and “Test” with
20% and 80% respectively of the total data from the BACE enzyme. There
is also a “Validation” set that contains data from a separate (but
related assay). (Note that these names are really misnomers. The “Test”
set would be called a validation set in standard machine-learning
practice and the “Validation” set would typically be called an external
test set.) Hence, we will rename the datasets after loading them.</p>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="n">splitter</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">splits</span><span class="o">.</span><span class="n">SpecifiedSplitter</span><span class="p">(</span><span class="n">dataset_file</span><span class="p">,</span> <span class="s2">&quot;Model&quot;</span><span class="p">)</span>
<span class="n">train_dataset</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">,</span> <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">splitter</span><span class="o">.</span><span class="n">train_valid_test_split</span><span class="p">(</span>
    <span class="n">dataset</span><span class="p">)</span>
<span class="c1">#NOTE THE RENAMING:</span>
<span class="n">valid_dataset</span><span class="p">,</span> <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">test_dataset</span><span class="p">,</span> <span class="n">valid_dataset</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>TIMING: dataset construction took 0.083 s
Loading dataset from disk.
TIMING: dataset construction took 0.062 s
Loading dataset from disk.
TIMING: dataset construction took 0.220 s
Loading dataset from disk.
</pre></div>
</div>
<p>Let’s quickly take a look at a compound in the validation set. (The
compound displayed earlier was drawn from the train set).</p>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">valid_dataset</span><span class="o">.</span><span class="n">ids</span><span class="p">)</span>
<span class="n">valid_mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">compound</span><span class="p">)</span>
              <span class="k">for</span> <span class="n">compound</span> <span class="ow">in</span> <span class="n">islice</span><span class="p">(</span><span class="n">valid_dataset</span><span class="o">.</span><span class="n">ids</span><span class="p">,</span> <span class="n">num_to_display</span><span class="p">)]</span>
<span class="n">display_images</span><span class="p">(</span><span class="n">mols_to_pngs</span><span class="p">(</span><span class="n">valid_mols</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="s2">&quot;valid_set&quot;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>[ &#39;S(=O)(=O)(N(C)c1cc(cc(c1)C(=O)NC(C(O)CC(OC)C(=O)NC(C(C)C)C(=O)NCc1ccccc1)COc1cc(F)cc(F)c1)C(=O)NC(C)c1ccccc1)C&#39;
 &#39;O=C(NCCC(C)(C)C)C(Cc1cc2cc(ccc2nc1N)-c1ccccc1C)C&#39;
 &#39;Fc1cc(cc(F)c1)CC(NC(=O)C(N1CCC(NC(=O)C)(C(CC)C)C1=O)CCc1ccccc1)C(O)C1[NH2+]CC(O)C1&#39;
 ..., &#39;Brc1cc(ccc1)C1CC1C=1N=C(N)N(C)C(=O)C=1&#39;
 &#39;O=C1N(C)C(=NC(=C1)C1CC1c1cc(ccc1)-c1ccccc1)N&#39;
 &#39;Clc1cc2nc(n(c2cc1)CCCC(=O)NCC1CC1)N&#39;]
</pre></div>
</div>
<img alt="../_images/BACE_17_1.png" src="../_images/BACE_17_1.png" />
<img alt="../_images/BACE_17_2.png" src="../_images/BACE_17_2.png" />
<img alt="../_images/BACE_17_3.png" src="../_images/BACE_17_3.png" />
<img alt="../_images/BACE_17_4.png" src="../_images/BACE_17_4.png" />
<img alt="../_images/BACE_17_5.png" src="../_images/BACE_17_5.png" />
<img alt="../_images/BACE_17_6.png" src="../_images/BACE_17_6.png" />
<img alt="../_images/BACE_17_7.png" src="../_images/BACE_17_7.png" />
<img alt="../_images/BACE_17_8.png" src="../_images/BACE_17_8.png" />
<img alt="../_images/BACE_17_9.png" src="../_images/BACE_17_9.png" />
<img alt="../_images/BACE_17_10.png" src="../_images/BACE_17_10.png" />
<img alt="../_images/BACE_17_11.png" src="../_images/BACE_17_11.png" />
<img alt="../_images/BACE_17_12.png" src="../_images/BACE_17_12.png" />
<p>Let’s now write these datasets to disk</p>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;Number of compounds in train set&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Number of compounds in validation set&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_dataset</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Number of compounds in test set&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Number of compounds in crystal set&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">crystal_dataset</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>Number of compounds in train set
204
Number of compounds in validation set
1273
Number of compounds in test set
45
Number of compounds in crystal set
25
</pre></div>
</div>
<p>The performance of common machine-learning algorithms can be very
sensitive to preprocessing of the data. One common transformation
applied to data is to normalize it to have zero-mean and
unit-standard-deviation. We will apply this transformation to the pIC50
values (as seen above, the pIC50s range from 2 to 11).</p>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="n">transformers</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">dc</span><span class="o">.</span><span class="n">trans</span><span class="o">.</span><span class="n">NormalizationTransformer</span><span class="p">(</span><span class="n">transform_X</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">train_dataset</span><span class="p">),</span>
    <span class="n">dc</span><span class="o">.</span><span class="n">trans</span><span class="o">.</span><span class="n">ClippingTransformer</span><span class="p">(</span><span class="n">transform_X</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">train_dataset</span><span class="p">)]</span>

<span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span><span class="n">train_dataset</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">,</span> <span class="n">test_dataset</span><span class="p">,</span> <span class="n">crystal_dataset</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">datasets</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">transformer</span> <span class="ow">in</span> <span class="n">transformers</span><span class="p">:</span>
      <span class="n">datasets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="n">train_dataset</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">,</span> <span class="n">test_dataset</span><span class="p">,</span> <span class="n">crystal_dataset</span> <span class="o">=</span> <span class="n">datasets</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>TIMING: dataset construction took 0.042 s
Loading dataset from disk.
TIMING: dataset construction took 0.028 s
Loading dataset from disk.
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>/home/leswing/Documents/deepchem/deepchem/trans/transformers.py:146: RuntimeWarning: invalid value encountered in true_divide
  X = np.nan_to_num((X - self.X_means) / self.X_stds)
/home/leswing/Documents/deepchem/deepchem/trans/transformers.py:146: RuntimeWarning: divide by zero encountered in true_divide
  X = np.nan_to_num((X - self.X_means) / self.X_stds)
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>TIMING: dataset construction took 0.235 s
Loading dataset from disk.
TIMING: dataset construction took 0.157 s
Loading dataset from disk.
TIMING: dataset construction took 0.011 s
Loading dataset from disk.
TIMING: dataset construction took 0.008 s
Loading dataset from disk.
TIMING: dataset construction took 0.007 s
Loading dataset from disk.
TIMING: dataset construction took 0.006 s
Loading dataset from disk.
</pre></div>
</div>
<p>We now fit simple random forest models to our datasets.</p>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="k">def</span> <span class="nf">rf_model_builder</span><span class="p">(</span><span class="n">model_params</span><span class="p">,</span> <span class="n">model_dir</span><span class="p">):</span>
  <span class="n">sklearn_model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="o">**</span><span class="n">model_params</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">dc</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">SklearnModel</span><span class="p">(</span><span class="n">sklearn_model</span><span class="p">,</span> <span class="n">model_dir</span><span class="p">)</span>
<span class="n">params_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;n_estimators&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="s2">&quot;max_features&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="s2">&quot;sqrt&quot;</span><span class="p">,</span> <span class="s2">&quot;log2&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">metric</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">Metric</span><span class="p">(</span><span class="n">dc</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">roc_auc_score</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">hyper</span><span class="o">.</span><span class="n">HyperparamOpt</span><span class="p">(</span><span class="n">rf_model_builder</span><span class="p">)</span>
<span class="n">best_rf</span><span class="p">,</span> <span class="n">best_rf_hyperparams</span><span class="p">,</span> <span class="n">all_rf_results</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">hyperparam_search</span><span class="p">(</span>
    <span class="n">params_dict</span><span class="p">,</span> <span class="n">train_dataset</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>Fitting model 1/8
hyperparameters: {&#39;n_estimators&#39;: 10, &#39;max_features&#39;: &#39;auto&#39;}
computed_metrics: [0.74319984817330365]
Model 1/8, Metric roc_auc_score, Validation set 0: 0.743200
    best_validation_score so far: 0.743200
Fitting model 2/8
hyperparameters: {&#39;n_estimators&#39;: 10, &#39;max_features&#39;: &#39;sqrt&#39;}
computed_metrics: [0.74326269034895009]
Model 2/8, Metric roc_auc_score, Validation set 1: 0.743263
    best_validation_score so far: 0.743263
Fitting model 3/8
hyperparameters: {&#39;n_estimators&#39;: 10, &#39;max_features&#39;: &#39;log2&#39;}
computed_metrics: [0.76930637320208528]
Model 3/8, Metric roc_auc_score, Validation set 2: 0.769306
    best_validation_score so far: 0.769306
Fitting model 4/8
hyperparameters: {&#39;n_estimators&#39;: 10, &#39;max_features&#39;: None}
computed_metrics: [0.7311448336190558]
Model 4/8, Metric roc_auc_score, Validation set 3: 0.731145
    best_validation_score so far: 0.769306
Fitting model 5/8
hyperparameters: {&#39;n_estimators&#39;: 100, &#39;max_features&#39;: &#39;auto&#39;}
computed_metrics: [0.78075181865256327]
Model 5/8, Metric roc_auc_score, Validation set 4: 0.780752
    best_validation_score so far: 0.780752
Fitting model 6/8
hyperparameters: {&#39;n_estimators&#39;: 100, &#39;max_features&#39;: &#39;sqrt&#39;}
computed_metrics: [0.7701943331439689]
Model 6/8, Metric roc_auc_score, Validation set 5: 0.770194
    best_validation_score so far: 0.780752
Fitting model 7/8
hyperparameters: {&#39;n_estimators&#39;: 100, &#39;max_features&#39;: &#39;log2&#39;}
computed_metrics: [0.78915318911472965]
Model 7/8, Metric roc_auc_score, Validation set 6: 0.789153
    best_validation_score so far: 0.789153
Fitting model 8/8
hyperparameters: {&#39;n_estimators&#39;: 100, &#39;max_features&#39;: None}
computed_metrics: [0.7625005655795809]
Model 8/8, Metric roc_auc_score, Validation set 7: 0.762501
    best_validation_score so far: 0.789153
computed_metrics: [0.99980776624375234]
Best hyperparameters: (100, &#39;log2&#39;)
train_score: 0.999808
validation_score: 0.789153
</pre></div>
</div>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy.random</span>

<span class="n">params_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;learning_rate&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">10.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
               <span class="s2">&quot;weight_decay_penalty&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
               <span class="s2">&quot;nb_epoch&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">40</span><span class="p">]</span> <span class="p">}</span>
<span class="n">n_features</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">get_data_shape</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">model_builder</span><span class="p">(</span><span class="n">model_params</span><span class="p">,</span> <span class="n">model_dir</span><span class="p">):</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MultiTaskClassifier</span><span class="p">(</span>
    <span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">],</span> <span class="n">dropouts</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="o">**</span><span class="n">model_params</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">model</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">hyper</span><span class="o">.</span><span class="n">HyperparamOpt</span><span class="p">(</span><span class="n">model_builder</span><span class="p">)</span>
<span class="n">best_dnn</span><span class="p">,</span> <span class="n">best_dnn_hyperparams</span><span class="p">,</span> <span class="n">all_dnn_results</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">hyperparam_search</span><span class="p">(</span>
    <span class="n">params_dict</span><span class="p">,</span> <span class="n">train_dataset</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>Fitting model 1/1
hyperparameters: {&#39;learning_rate&#39;: 0.00052483044910693708, &#39;weight_decay_penalty&#39;: 7.4100784969101178e-06, &#39;nb_epoch&#39;: 40}
Ending global_step 200: Average loss 35.8528
TIMING: model fitting took 1.648 s
computed_metrics: [0.78873088969438587]
Model 1/1, Metric roc_auc_score, Validation set 0: 0.788731
    best_validation_score so far: 0.788731
computed_metrics: [0.94530949634755868]
Best hyperparameters: (0.00052483044910693708, 7.4100784969101178e-06, 40)
train_score: 0.945309
validation_score: 0.788731
</pre></div>
</div>
<p>Now let’s evaluate the best model on the validation and test sets and
save the results to csv.</p>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">deepchem.utils.evaluate</span> <span class="kn">import</span> <span class="n">Evaluator</span>

<span class="n">rf_train_csv_out</span> <span class="o">=</span> <span class="s2">&quot;rf_train_regressor.csv&quot;</span>
<span class="n">rf_train_stats_out</span> <span class="o">=</span> <span class="s2">&quot;rf_train_stats_regressor.txt&quot;</span>
<span class="n">rf_train_evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">best_rf</span><span class="p">,</span> <span class="n">train_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">)</span>
<span class="n">rf_train_score</span> <span class="o">=</span> <span class="n">rf_train_evaluator</span><span class="o">.</span><span class="n">compute_model_performance</span><span class="p">(</span>
    <span class="p">[</span><span class="n">metric</span><span class="p">],</span> <span class="n">rf_train_csv_out</span><span class="p">,</span> <span class="n">rf_train_stats_out</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;RF Train set AUC </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rf_train_score</span><span class="p">[</span><span class="s2">&quot;roc_auc_score&quot;</span><span class="p">]))</span>

<span class="n">rf_valid_csv_out</span> <span class="o">=</span> <span class="s2">&quot;rf_valid_regressor.csv&quot;</span>
<span class="n">rf_valid_stats_out</span> <span class="o">=</span> <span class="s2">&quot;rf_valid_stats_regressor.txt&quot;</span>
<span class="n">rf_valid_evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">best_rf</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">)</span>
<span class="n">rf_valid_score</span> <span class="o">=</span> <span class="n">rf_valid_evaluator</span><span class="o">.</span><span class="n">compute_model_performance</span><span class="p">(</span>
    <span class="p">[</span><span class="n">metric</span><span class="p">],</span> <span class="n">rf_valid_csv_out</span><span class="p">,</span> <span class="n">rf_valid_stats_out</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;RF Valid set AUC </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rf_valid_score</span><span class="p">[</span><span class="s2">&quot;roc_auc_score&quot;</span><span class="p">]))</span>

<span class="n">rf_test_csv_out</span> <span class="o">=</span> <span class="s2">&quot;rf_test_regressor.csv&quot;</span>
<span class="n">rf_test_stats_out</span> <span class="o">=</span> <span class="s2">&quot;rf_test_stats_regressor.txt&quot;</span>
<span class="n">rf_test_evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">best_rf</span><span class="p">,</span> <span class="n">test_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">)</span>
<span class="n">rf_test_score</span> <span class="o">=</span> <span class="n">rf_test_evaluator</span><span class="o">.</span><span class="n">compute_model_performance</span><span class="p">(</span>
    <span class="p">[</span><span class="n">metric</span><span class="p">],</span> <span class="n">rf_test_csv_out</span><span class="p">,</span> <span class="n">rf_test_stats_out</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;RF Test set AUC </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rf_test_score</span><span class="p">[</span><span class="s2">&quot;roc_auc_score&quot;</span><span class="p">]))</span>

<span class="n">rf_crystal_csv_out</span> <span class="o">=</span> <span class="s2">&quot;rf_crystal_regressor.csv&quot;</span>
<span class="n">rf_crystal_stats_out</span> <span class="o">=</span> <span class="s2">&quot;rf_crystal_stats_regressor.txt&quot;</span>
<span class="n">rf_crystal_evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">best_rf</span><span class="p">,</span> <span class="n">crystal_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">)</span>
<span class="n">rf_crystal_score</span> <span class="o">=</span> <span class="n">rf_crystal_evaluator</span><span class="o">.</span><span class="n">compute_model_performance</span><span class="p">(</span>
    <span class="p">[</span><span class="n">metric</span><span class="p">],</span> <span class="n">rf_crystal_csv_out</span><span class="p">,</span> <span class="n">rf_crystal_stats_out</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;RF Crystal set R^2 </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rf_crystal_score</span><span class="p">[</span><span class="s2">&quot;roc_auc_score&quot;</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>computed_metrics: [0.99980776624375234]
RF Train set AUC 0.999808
computed_metrics: [0.78915318911472965]
RF Valid set AUC 0.789153
computed_metrics: [0.68181818181818177]
RF Test set AUC 0.681818
computed_metrics: [nan]
RF Crystal set R^2 nan
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>/home/leswing/Documents/deepchem/deepchem/metrics/__init__.py:297: UserWarning: Error calculating metric roc_auc_score: Only one class present in y_true. ROC AUC score is not defined in that case.
  warnings.warn(&quot;Error calculating metric %s: %s&quot; % (self.name, e))
</pre></div>
</div>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="n">dnn_train_csv_out</span> <span class="o">=</span> <span class="s2">&quot;dnn_train_classifier.csv&quot;</span>
<span class="n">dnn_train_stats_out</span> <span class="o">=</span> <span class="s2">&quot;dnn_train_classifier_stats.txt&quot;</span>
<span class="n">dnn_train_evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">best_dnn</span><span class="p">,</span> <span class="n">train_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">)</span>
<span class="n">dnn_train_score</span> <span class="o">=</span> <span class="n">dnn_train_evaluator</span><span class="o">.</span><span class="n">compute_model_performance</span><span class="p">(</span>
    <span class="p">[</span><span class="n">metric</span><span class="p">],</span> <span class="n">dnn_train_csv_out</span><span class="p">,</span> <span class="n">dnn_train_stats_out</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;DNN Train set AUC </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dnn_train_score</span><span class="p">[</span><span class="s2">&quot;roc_auc_score&quot;</span><span class="p">]))</span>

<span class="n">dnn_valid_csv_out</span> <span class="o">=</span> <span class="s2">&quot;dnn_valid_classifier.csv&quot;</span>
<span class="n">dnn_valid_stats_out</span> <span class="o">=</span> <span class="s2">&quot;dnn_valid_classifier_stats.txt&quot;</span>
<span class="n">dnn_valid_evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">best_dnn</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">)</span>
<span class="n">dnn_valid_score</span> <span class="o">=</span> <span class="n">dnn_valid_evaluator</span><span class="o">.</span><span class="n">compute_model_performance</span><span class="p">(</span>
    <span class="p">[</span><span class="n">metric</span><span class="p">],</span> <span class="n">dnn_valid_csv_out</span><span class="p">,</span> <span class="n">dnn_valid_stats_out</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;DNN Valid set AUC </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dnn_valid_score</span><span class="p">[</span><span class="s2">&quot;roc_auc_score&quot;</span><span class="p">]))</span>

<span class="n">dnn_test_csv_out</span> <span class="o">=</span> <span class="s2">&quot;dnn_test_classifier.csv&quot;</span>
<span class="n">dnn_test_stats_out</span> <span class="o">=</span> <span class="s2">&quot;dnn_test_classifier_stats.txt&quot;</span>
<span class="n">dnn_test_evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">best_dnn</span><span class="p">,</span> <span class="n">test_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">)</span>
<span class="n">dnn_test_score</span> <span class="o">=</span> <span class="n">dnn_test_evaluator</span><span class="o">.</span><span class="n">compute_model_performance</span><span class="p">(</span>
    <span class="p">[</span><span class="n">metric</span><span class="p">],</span> <span class="n">dnn_test_csv_out</span><span class="p">,</span> <span class="n">dnn_test_stats_out</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;DNN Test set AUC </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dnn_test_score</span><span class="p">[</span><span class="s2">&quot;roc_auc_score&quot;</span><span class="p">]))</span>

<span class="n">dnn_crystal_csv_out</span> <span class="o">=</span> <span class="s2">&quot;dnn_crystal_classifier.csv&quot;</span>
<span class="n">dnn_crystal_stats_out</span> <span class="o">=</span> <span class="s2">&quot;dnn_crystal_stats_classifier.txt&quot;</span>
<span class="n">dnn_crystal_evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">best_dnn</span><span class="p">,</span> <span class="n">crystal_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">)</span>
<span class="n">dnn_crystal_score</span> <span class="o">=</span> <span class="n">dnn_crystal_evaluator</span><span class="o">.</span><span class="n">compute_model_performance</span><span class="p">(</span>
    <span class="p">[</span><span class="n">metric</span><span class="p">],</span> <span class="n">dnn_crystal_csv_out</span><span class="p">,</span> <span class="n">dnn_crystal_stats_out</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;DNN Crystal set AUC </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dnn_crystal_score</span><span class="p">[</span><span class="s2">&quot;roc_auc_score&quot;</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>computed_metrics: [0.94530949634755868]
DNN Train set AUC 0.945309
computed_metrics: [0.78873088969438587]
DNN Valid set AUC 0.788731
computed_metrics: [0.44318181818181818]
DNN Test set AUC 0.443182
computed_metrics: [nan]
DNN Crystal set AUC nan
</pre></div>
</div>
<p>Now, we construct regression models for the data.</p>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="c1">#Make directories to store the raw and featurized datasets.</span>
<span class="n">featurizer</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">feat</span><span class="o">.</span><span class="n">UserDefinedFeaturizer</span><span class="p">(</span><span class="n">user_specified_features</span><span class="p">)</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">UserCSVLoader</span><span class="p">(</span>
    <span class="n">tasks</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pIC50&quot;</span><span class="p">],</span> <span class="n">smiles_field</span><span class="o">=</span><span class="s2">&quot;mol&quot;</span><span class="p">,</span> <span class="n">id_field</span><span class="o">=</span><span class="s2">&quot;CID&quot;</span><span class="p">,</span>
    <span class="n">featurizer</span><span class="o">=</span><span class="n">featurizer</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">featurize</span><span class="p">(</span><span class="n">dataset_file</span><span class="p">)</span>
<span class="n">crystal_dataset</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">featurize</span><span class="p">(</span><span class="n">crystal_dataset_file</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>Loading raw samples now.
shard_size: 8192
About to start loading CSV from desc_canvas_aug30.csv
Loading shard 1 of size 8192.
TIMING: user specified processing took 0.113 s
TIMING: featurizing shard 0 took 0.118 s
TIMING: dataset construction took 0.387 s
Loading dataset from disk.
Loading raw samples now.
shard_size: 8192
About to start loading CSV from crystal_desc_canvas_aug30.csv
Loading shard 1 of size 8192.
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>/home/leswing/Documents/deepchem/deepchem/data/data_loader.py:42: UnicodeWarning: Unicode equal comparison failed to convert both arguments to Unicode - interpreting them as being unequal
  if y[ind, task] == &quot;&quot;:
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>TIMING: user specified processing took 0.105 s
TIMING: featurizing shard 0 took 0.105 s
TIMING: dataset construction took 0.133 s
Loading dataset from disk.
</pre></div>
</div>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="n">splitter</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">splits</span><span class="o">.</span><span class="n">SpecifiedSplitter</span><span class="p">(</span><span class="n">dataset_file</span><span class="p">,</span> <span class="s2">&quot;Model&quot;</span><span class="p">)</span>
<span class="n">train_dataset</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">,</span> <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">splitter</span><span class="o">.</span><span class="n">train_valid_test_split</span><span class="p">(</span>
    <span class="n">dataset</span><span class="p">)</span>
<span class="c1">#NOTE THE RENAMING:</span>
<span class="n">valid_dataset</span><span class="p">,</span> <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">test_dataset</span><span class="p">,</span> <span class="n">valid_dataset</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>TIMING: dataset construction took 0.084 s
Loading dataset from disk.
TIMING: dataset construction took 0.063 s
Loading dataset from disk.
TIMING: dataset construction took 0.222 s
Loading dataset from disk.
</pre></div>
</div>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;Number of compounds in train set&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Number of compounds in validation set&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_dataset</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Number of compounds in test set&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Number of compounds in crystal set&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">crystal_dataset</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>Number of compounds in train set
204
Number of compounds in validation set
1273
Number of compounds in test set
45
Number of compounds in crystal set
25
</pre></div>
</div>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="n">transformers</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">dc</span><span class="o">.</span><span class="n">trans</span><span class="o">.</span><span class="n">NormalizationTransformer</span><span class="p">(</span><span class="n">transform_X</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">train_dataset</span><span class="p">),</span>
    <span class="n">dc</span><span class="o">.</span><span class="n">trans</span><span class="o">.</span><span class="n">ClippingTransformer</span><span class="p">(</span><span class="n">transform_X</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">train_dataset</span><span class="p">)]</span>

<span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span><span class="n">train_dataset</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">,</span> <span class="n">test_dataset</span><span class="p">,</span> <span class="n">crystal_dataset</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">datasets</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">transformer</span> <span class="ow">in</span> <span class="n">transformers</span><span class="p">:</span>
      <span class="n">datasets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="n">train_dataset</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">,</span> <span class="n">test_dataset</span><span class="p">,</span> <span class="n">crystal_dataset</span> <span class="o">=</span> <span class="n">datasets</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>TIMING: dataset construction took 0.042 s
Loading dataset from disk.
TIMING: dataset construction took 0.028 s
Loading dataset from disk.
TIMING: dataset construction took 0.240 s
Loading dataset from disk.
TIMING: dataset construction took 0.153 s
Loading dataset from disk.
TIMING: dataset construction took 0.011 s
Loading dataset from disk.
TIMING: dataset construction took 0.008 s
Loading dataset from disk.
TIMING: dataset construction took 0.007 s
Loading dataset from disk.
TIMING: dataset construction took 0.006 s
Loading dataset from disk.
</pre></div>
</div>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>

<span class="k">def</span> <span class="nf">rf_model_builder</span><span class="p">(</span><span class="n">model_params</span><span class="p">,</span> <span class="n">model_dir</span><span class="p">):</span>
  <span class="n">sklearn_model</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="o">**</span><span class="n">model_params</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">dc</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">SklearnModel</span><span class="p">(</span><span class="n">sklearn_model</span><span class="p">,</span> <span class="n">model_dir</span><span class="p">)</span>
<span class="n">params_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;n_estimators&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="s2">&quot;max_features&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="s2">&quot;sqrt&quot;</span><span class="p">,</span> <span class="s2">&quot;log2&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">metric</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">Metric</span><span class="p">(</span><span class="n">dc</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">hyper</span><span class="o">.</span><span class="n">HyperparamOpt</span><span class="p">(</span><span class="n">rf_model_builder</span><span class="p">)</span>
<span class="n">best_rf</span><span class="p">,</span> <span class="n">best_rf_hyperparams</span><span class="p">,</span> <span class="n">all_rf_results</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">hyperparam_search</span><span class="p">(</span>
    <span class="n">params_dict</span><span class="p">,</span> <span class="n">train_dataset</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>Fitting model 1/8
hyperparameters: {&#39;n_estimators&#39;: 10, &#39;max_features&#39;: &#39;auto&#39;}
computed_metrics: [0.23108425266733013]
Model 1/8, Metric r2_score, Validation set 0: 0.231084
    best_validation_score so far: 0.231084
Fitting model 2/8
hyperparameters: {&#39;n_estimators&#39;: 10, &#39;max_features&#39;: &#39;sqrt&#39;}
computed_metrics: [0.22418271157591707]
Model 2/8, Metric r2_score, Validation set 1: 0.224183
    best_validation_score so far: 0.231084
Fitting model 3/8
hyperparameters: {&#39;n_estimators&#39;: 10, &#39;max_features&#39;: &#39;log2&#39;}
computed_metrics: [0.20636788964286401]
Model 3/8, Metric r2_score, Validation set 2: 0.206368
    best_validation_score so far: 0.231084
Fitting model 4/8
hyperparameters: {&#39;n_estimators&#39;: 10, &#39;max_features&#39;: None}
computed_metrics: [0.18314688084011943]
Model 4/8, Metric r2_score, Validation set 3: 0.183147
    best_validation_score so far: 0.231084
Fitting model 5/8
hyperparameters: {&#39;n_estimators&#39;: 100, &#39;max_features&#39;: &#39;auto&#39;}
computed_metrics: [0.23374315986590766]
Model 5/8, Metric r2_score, Validation set 4: 0.233743
    best_validation_score so far: 0.233743
Fitting model 6/8
hyperparameters: {&#39;n_estimators&#39;: 100, &#39;max_features&#39;: &#39;sqrt&#39;}
computed_metrics: [0.2568151370288233]
Model 6/8, Metric r2_score, Validation set 5: 0.256815
    best_validation_score so far: 0.256815
Fitting model 7/8
hyperparameters: {&#39;n_estimators&#39;: 100, &#39;max_features&#39;: &#39;log2&#39;}
computed_metrics: [0.25656689752672734]
Model 7/8, Metric r2_score, Validation set 6: 0.256567
    best_validation_score so far: 0.256815
Fitting model 8/8
hyperparameters: {&#39;n_estimators&#39;: 100, &#39;max_features&#39;: None}
computed_metrics: [0.22979820418679209]
Model 8/8, Metric r2_score, Validation set 7: 0.229798
    best_validation_score so far: 0.256815
computed_metrics: [0.94719919039600053]
Best hyperparameters: (100, &#39;sqrt&#39;)
train_score: 0.947199
validation_score: 0.256815
</pre></div>
</div>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy.random</span>

<span class="n">params_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;learning_rate&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">10.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">)),</span>
               <span class="s2">&quot;weight_decay_penalty&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">)),</span>
               <span class="s2">&quot;nb_epoch&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="p">}</span>
<span class="n">n_features</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">get_data_shape</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">model_builder</span><span class="p">(</span><span class="n">model_params</span><span class="p">,</span> <span class="n">model_dir</span><span class="p">):</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MultiTaskRegressor</span><span class="p">(</span>
    <span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">],</span> <span class="n">dropouts</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">25</span><span class="p">],</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="o">**</span><span class="n">model_params</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">model</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">hyper</span><span class="o">.</span><span class="n">HyperparamOpt</span><span class="p">(</span><span class="n">model_builder</span><span class="p">)</span>
<span class="n">best_dnn</span><span class="p">,</span> <span class="n">best_dnn_hyperparams</span><span class="p">,</span> <span class="n">all_dnn_results</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">hyperparam_search</span><span class="p">(</span>
    <span class="n">params_dict</span><span class="p">,</span> <span class="n">train_dataset</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>Fitting model 1/4
hyperparameters: {&#39;learning_rate&#39;: 2.2678896615378055e-05, &#39;weight_decay_penalty&#39;: 9.4634124652809741e-06, &#39;nb_epoch&#39;: 20}
Ending global_step 100: Average loss 180.546
TIMING: model fitting took 0.816 s
computed_metrics: [0.16989573357278653]
Model 1/4, Metric r2_score, Validation set 0: 0.169896
    best_validation_score so far: 0.169896
Fitting model 2/4
hyperparameters: {&#39;learning_rate&#39;: 2.2678896615378055e-05, &#39;weight_decay_penalty&#39;: 9.9538524586146781e-06, &#39;nb_epoch&#39;: 20}
Ending global_step 100: Average loss 257.12
TIMING: model fitting took 0.826 s
computed_metrics: [0.16619212054975674]
Model 2/4, Metric r2_score, Validation set 1: 0.166192
    best_validation_score so far: 0.169896
Fitting model 3/4
hyperparameters: {&#39;learning_rate&#39;: 3.2512632922566059e-05, &#39;weight_decay_penalty&#39;: 9.4634124652809741e-06, &#39;nb_epoch&#39;: 20}
Ending global_step 100: Average loss 179.655
TIMING: model fitting took 0.804 s
computed_metrics: [0.16680436151619304]
Model 3/4, Metric r2_score, Validation set 2: 0.166804
    best_validation_score so far: 0.169896
Fitting model 4/4
hyperparameters: {&#39;learning_rate&#39;: 3.2512632922566059e-05, &#39;weight_decay_penalty&#39;: 9.9538524586146781e-06, &#39;nb_epoch&#39;: 20}
Ending global_step 100: Average loss 174.068
TIMING: model fitting took 0.836 s
computed_metrics: [0.16242558602166368]
Model 4/4, Metric r2_score, Validation set 3: 0.162426
    best_validation_score so far: 0.169896
computed_metrics: [0.39815395176163104]
Best hyperparameters: (2.2678896615378055e-05, 9.4634124652809741e-06, 20)
train_score: 0.398154
validation_score: 0.169896
</pre></div>
</div>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">deepchem.utils.evaluate</span> <span class="kn">import</span> <span class="n">Evaluator</span>

<span class="n">rf_train_csv_out</span> <span class="o">=</span> <span class="s2">&quot;rf_train_regressor.csv&quot;</span>
<span class="n">rf_train_stats_out</span> <span class="o">=</span> <span class="s2">&quot;rf_train_stats_regressor.txt&quot;</span>
<span class="n">rf_train_evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">best_rf</span><span class="p">,</span> <span class="n">train_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">)</span>
<span class="n">rf_train_score</span> <span class="o">=</span> <span class="n">rf_train_evaluator</span><span class="o">.</span><span class="n">compute_model_performance</span><span class="p">(</span>
    <span class="p">[</span><span class="n">metric</span><span class="p">],</span> <span class="n">rf_train_csv_out</span><span class="p">,</span> <span class="n">rf_train_stats_out</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;RF Train set R^2 </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rf_train_score</span><span class="p">[</span><span class="s2">&quot;r2_score&quot;</span><span class="p">]))</span>

<span class="n">rf_valid_csv_out</span> <span class="o">=</span> <span class="s2">&quot;rf_valid_regressor.csv&quot;</span>
<span class="n">rf_valid_stats_out</span> <span class="o">=</span> <span class="s2">&quot;rf_valid_stats_regressor.txt&quot;</span>
<span class="n">rf_valid_evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">best_rf</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">)</span>
<span class="n">rf_valid_score</span> <span class="o">=</span> <span class="n">rf_valid_evaluator</span><span class="o">.</span><span class="n">compute_model_performance</span><span class="p">(</span>
    <span class="p">[</span><span class="n">metric</span><span class="p">],</span> <span class="n">rf_valid_csv_out</span><span class="p">,</span> <span class="n">rf_valid_stats_out</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;RF Valid set R^2 </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rf_valid_score</span><span class="p">[</span><span class="s2">&quot;r2_score&quot;</span><span class="p">]))</span>

<span class="n">rf_test_csv_out</span> <span class="o">=</span> <span class="s2">&quot;rf_test_regressor.csv&quot;</span>
<span class="n">rf_test_stats_out</span> <span class="o">=</span> <span class="s2">&quot;rf_test_stats_regressor.txt&quot;</span>
<span class="n">rf_test_evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">best_rf</span><span class="p">,</span> <span class="n">test_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">)</span>
<span class="n">rf_test_score</span> <span class="o">=</span> <span class="n">rf_test_evaluator</span><span class="o">.</span><span class="n">compute_model_performance</span><span class="p">(</span>
    <span class="p">[</span><span class="n">metric</span><span class="p">],</span> <span class="n">rf_test_csv_out</span><span class="p">,</span> <span class="n">rf_test_stats_out</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;RF Test set R^2 </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rf_test_score</span><span class="p">[</span><span class="s2">&quot;r2_score&quot;</span><span class="p">]))</span>

<span class="n">rf_crystal_csv_out</span> <span class="o">=</span> <span class="s2">&quot;rf_crystal_regressor.csv&quot;</span>
<span class="n">rf_crystal_stats_out</span> <span class="o">=</span> <span class="s2">&quot;rf_crystal_stats_regressor.txt&quot;</span>
<span class="n">rf_crystal_evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">best_rf</span><span class="p">,</span> <span class="n">crystal_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">)</span>
<span class="n">rf_crystal_score</span> <span class="o">=</span> <span class="n">rf_crystal_evaluator</span><span class="o">.</span><span class="n">compute_model_performance</span><span class="p">(</span>
    <span class="p">[</span><span class="n">metric</span><span class="p">],</span> <span class="n">rf_crystal_csv_out</span><span class="p">,</span> <span class="n">rf_crystal_stats_out</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;RF Crystal set R^2 </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rf_crystal_score</span><span class="p">[</span><span class="s2">&quot;r2_score&quot;</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>computed_metrics: [0.94719919039600053]
RF Train set R^2 0.947199
computed_metrics: [0.2568151370288233]
RF Valid set R^2 0.256815
computed_metrics: [0.49355860458612211]
RF Test set R^2 0.493559
computed_metrics: [nan]
RF Crystal set R^2 nan
</pre></div>
</div>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="n">dnn_train_csv_out</span> <span class="o">=</span> <span class="s2">&quot;dnn_train_regressor.csv&quot;</span>
<span class="n">dnn_train_stats_out</span> <span class="o">=</span> <span class="s2">&quot;dnn_train_regressor_stats.txt&quot;</span>
<span class="n">dnn_train_evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">best_dnn</span><span class="p">,</span> <span class="n">train_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">)</span>
<span class="n">dnn_train_score</span> <span class="o">=</span> <span class="n">dnn_train_evaluator</span><span class="o">.</span><span class="n">compute_model_performance</span><span class="p">(</span>
    <span class="p">[</span><span class="n">metric</span><span class="p">],</span> <span class="n">dnn_train_csv_out</span><span class="p">,</span> <span class="n">dnn_train_stats_out</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;DNN Train set R^2 </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dnn_train_score</span><span class="p">[</span><span class="s2">&quot;r2_score&quot;</span><span class="p">]))</span>

<span class="n">dnn_valid_csv_out</span> <span class="o">=</span> <span class="s2">&quot;dnn_valid_regressor.csv&quot;</span>
<span class="n">dnn_valid_stats_out</span> <span class="o">=</span> <span class="s2">&quot;dnn_valid_regressor_stats.txt&quot;</span>
<span class="n">dnn_valid_evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">best_dnn</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">)</span>
<span class="n">dnn_valid_score</span> <span class="o">=</span> <span class="n">dnn_valid_evaluator</span><span class="o">.</span><span class="n">compute_model_performance</span><span class="p">(</span>
    <span class="p">[</span><span class="n">metric</span><span class="p">],</span> <span class="n">dnn_valid_csv_out</span><span class="p">,</span> <span class="n">dnn_valid_stats_out</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;DNN Valid set R^2 </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dnn_valid_score</span><span class="p">[</span><span class="s2">&quot;r2_score&quot;</span><span class="p">]))</span>

<span class="n">dnn_test_csv_out</span> <span class="o">=</span> <span class="s2">&quot;dnn_test_regressor.csv&quot;</span>
<span class="n">dnn_test_stats_out</span> <span class="o">=</span> <span class="s2">&quot;dnn_test_regressor_stats.txt&quot;</span>
<span class="n">dnn_test_evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">best_dnn</span><span class="p">,</span> <span class="n">test_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">)</span>
<span class="n">dnn_test_score</span> <span class="o">=</span> <span class="n">dnn_test_evaluator</span><span class="o">.</span><span class="n">compute_model_performance</span><span class="p">(</span>
    <span class="p">[</span><span class="n">metric</span><span class="p">],</span> <span class="n">dnn_test_csv_out</span><span class="p">,</span> <span class="n">dnn_test_stats_out</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;DNN Test set R^2 </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dnn_test_score</span><span class="p">[</span><span class="s2">&quot;r2_score&quot;</span><span class="p">]))</span>

<span class="n">dnn_crystal_csv_out</span> <span class="o">=</span> <span class="s2">&quot;dnn_crystal_regressor.csv&quot;</span>
<span class="n">dnn_crystal_stats_out</span> <span class="o">=</span> <span class="s2">&quot;dnn_crystal_stats_regressor.txt&quot;</span>
<span class="n">dnn_crystal_evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">best_dnn</span><span class="p">,</span> <span class="n">crystal_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">)</span>
<span class="n">dnn_crystal_score</span> <span class="o">=</span> <span class="n">dnn_crystal_evaluator</span><span class="o">.</span><span class="n">compute_model_performance</span><span class="p">(</span>
    <span class="p">[</span><span class="n">metric</span><span class="p">],</span> <span class="n">dnn_crystal_csv_out</span><span class="p">,</span> <span class="n">dnn_crystal_stats_out</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;DNN Crystal set R^2 </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dnn_crystal_score</span><span class="p">[</span><span class="s2">&quot;r2_score&quot;</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>computed_metrics: [0.39815395176163104]
DNN Train set R^2 0.398154
computed_metrics: [0.16989573357278653]
DNN Valid set R^2 0.169896
computed_metrics: [0.25610212044851555]
DNN Test set R^2 0.256102
computed_metrics: [nan]
DNN Crystal set R^2 nan
</pre></div>
</div>
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="n">task</span> <span class="o">=</span> <span class="s2">&quot;pIC50&quot;</span>
<span class="n">rf_predicted_test</span> <span class="o">=</span> <span class="n">best_rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">)</span>
<span class="n">rf_true_test</span> <span class="o">=</span> <span class="n">test_dataset</span><span class="o">.</span><span class="n">y</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">rf_predicted_test</span><span class="p">,</span> <span class="n">rf_true_test</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted pIC50s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Secondary Assay&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;RF predicted IC50 vs. Secondary Assay&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/BACE_37_0.png" src="../_images/BACE_37_0.png" />
<div class="code ipython2 highlight-python"><div class="highlight"><pre><span></span><span class="n">task</span> <span class="o">=</span> <span class="s2">&quot;pIC50&quot;</span>
<span class="n">dnn_predicted_test</span> <span class="o">=</span> <span class="n">best_dnn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">)</span>
<span class="n">dnn_true_test</span> <span class="o">=</span> <span class="n">test_dataset</span><span class="o">.</span><span class="n">y</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dnn_predicted_test</span><span class="p">,</span> <span class="n">dnn_true_test</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted pIC50s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Secondary Assay&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;DNN predicted IC50 vs. Secondary Assay&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/BACE_38_0.png" src="../_images/BACE_38_0.png" />
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../_sources/notebooks/BACE.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2016, Stanford University and the Authors.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>